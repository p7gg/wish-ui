import { createGenerateId, mergeDefaultProps } from "@kobalte/utils";
import { createUniqueId, splitProps } from "solid-js";
import { createDisclosureState } from "../primitives";
import { Menu } from "./menu";
import { MenuRootContext } from "./menu-root-context";
/**
 * Root component for a menu, provide context for its children.
 * Used to build dropdown menu, context menu and menubar.
 */
export function MenuRoot(props) {
    const defaultId = `menu-${createUniqueId()}`;
    props = mergeDefaultProps({
        id: defaultId,
        isModal: true,
    }, props);
    const [local, others] = splitProps(props, [
        "id",
        "isModal",
        "forceMount",
        "isOpen",
        "defaultIsOpen",
        "onOpenChange",
    ]);
    const disclosureState = createDisclosureState({
        isOpen: () => local.isOpen,
        defaultIsOpen: () => local.defaultIsOpen,
        onOpenChange: isOpen => local.onOpenChange?.(isOpen),
    });
    const context = {
        isModal: () => local.isModal ?? true,
        forceMount: () => local.forceMount ?? false,
        close: disclosureState.close,
        generateId: createGenerateId(() => local.id),
    };
    return (<MenuRootContext.Provider value={context}>
      <Menu isOpen={disclosureState.isOpen()} onOpenChange={disclosureState.setIsOpen} {...others}/>
    </MenuRootContext.Provider>);
}
